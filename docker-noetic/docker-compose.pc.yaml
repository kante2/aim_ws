services:
  aim-noetic-pc:
    build:
      context: ..                 # ë¦¬í¬ ë£¨íŠ¸(~/''')
      dockerfile: docker-noetic/Dockerfile
    image: aim-noetic:pc
    container_name: aim-noetic-pc

    # í˜¸ìŠ¤íŠ¸ì™€ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì‚¬ìš©(ROS í†µì‹  í¸ì˜)
    network_mode: host
    gpus: all

    # GPU ì „ë‹¬ (NVIDIA 4050)
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=graphics,utility,compute
      - DISPLAY=${DISPLAY}
      - QT_X11_NO_MITSHM=1

      # ğŸ”½ í•˜ì´ë¸Œë¦¬ë“œ(AMD+iGPU + NVIDIA dGPU)ì—ì„œ NVIDIA ê°•ì œ
      - __NV_PRIME_RENDER_OFFLOAD=1
      - __GLX_VENDOR_LIBRARY_NAME=nvidia
      - __VK_LAYER_NV_optimus=NVIDIA_only
      # ì„ íƒ: Wayland í™˜ê²½ì´ë©´ ê°™ì´ ì£¼ëŠ” ê²Œ ì•ˆì „
      - XDG_RUNTIME_DIR=${XDG_RUNTIME_DIR}

    volumes:
      - /tmp/.X11-unix:/tmp/.X11-unix:rw
      - ${HOME}/aim_ws:/root/aim_ws:rw
      - /etc/localtime:/etc/localtime:ro
      - /home/kante/Downloads/MoraiLauncher_Lin:/mnt/MoraiLauncher_Lin:ro
      # Wayland ì†Œì¼“(ì„ íƒ, Ubuntu ê¸°ë³¸ì´ Waylandë©´ ì¶”ì²œ)
      - /run/user/${UID:-1000}:/run/user/${UID:-1000}

    # (ì˜µì…˜) ì›¹ìº /ì‹œë¦¬ì–¼ ì“¸ ê±°ë©´ ì•„ë˜ ì£¼ì„ í•´ì œ
    # devices:
    #   - /dev/video0:/dev/video0
    #   - /dev/ttyUSB0:/dev/ttyUSB0

    # /dev/shm ìš©ëŸ‰ ë¶€ì¡±ì‹œ GUI ì¶©ëŒ ë°©ì§€
    shm_size: "2gb"

    stdin_open: true
    tty: true
    command: ["tail","-f","/dev/null"]

    # í•„ìš”í•˜ë©´ ì¬ì‹œì‘ ì •ì±… ì‚¬ìš©
    # restart: unless-stopped
