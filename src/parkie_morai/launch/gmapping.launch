<launch>
  <!-- ===== Args (필요시 수정) ===== -->
  <arg name="use_sim_time" default="false"/>
  <arg name="scan_topic"   default="/scan"/>

  <arg name="base_frame"   default="base_link"/>
  <arg name="odom_frame"   default="odom"/>
  <arg name="map_frame"    default="map"/>

  <arg name="linearUpdate" value="0.2"/>
  <arg name="angularUpdate" value="0.1"/>
  <arg name="maxUrange"    value="12.0"/>
  <arg name="particles"    value="30"/>
  <arg name="throttle_scans" default="1"/>

  <!-- RViz 설정 -->
  <arg name="rviz"         default="true"/>
  <arg name="rviz_config"  default="$(find parkie_morai)/rviz/display_new.rviz"/>

  <!-- ===== 공통 파라미터 ===== -->
  <param name="use_sim_time" value="$(arg use_sim_time)"/>

  <!-- ===== GMapping ===== -->
  <node pkg="gmapping" type="slam_gmapping" name="slam_gmapping" output="screen">
    <param name="base_frame" value="$(arg base_frame)"/>
    <param name="odom_frame" value="$(arg odom_frame)"/>
    <param name="map_frame"  value="$(arg map_frame)"/>

    <!-- 안정화/성능 파라미터 -->
    <param name="linearUpdate"        value="$(arg linearUpdate)"/>
    <param name="angularUpdate"       value="$(arg angularUpdate)"/>
    <param name="map_update_interval" value="2.0"/>
    <param name="maxUrange"           value="$(arg maxUrange)"/>
    <param name="particles"           value="$(arg particles)"/>
    <param name="throttle_scans"      value="$(arg throttle_scans)"/>

    <!-- 스캔 리매핑 -->
    <remap from="scan" to="$(arg scan_topic)"/>
  </node>

  <!-- ===== RViz (옵션) ===== -->
  <node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz"
        args="-d $(arg rviz_config)"/>
</launch>
